# 版本更新日志

## [0.1.4] - 2024-12-05

### 🐛 Bug修复
- **历练系统**: 修复AI返回JSON格式错误导致气血和修为显示NaN的问题
  - 在AI服务中添加数据验证，确保所有必需字段都有有效的数字值
  - 在历练处理逻辑中添加安全检查，防止NaN传播到玩家状态
  - 支持字符串数字的自动转换
  - 当AI返回不完整或格式错误的JSON时，使用安全的默认值（0）替代

### 🔧 优化改进
- **功法阁**: 为学习功法功能添加弹窗提醒
  - 当功法无法学习时，显示友好的弹窗提示而不是仅在日志中显示
  - 支持多种错误情况的弹窗提醒：
    - 已学习过的功法
    - 灵石不足（显示所需和当前数量）
    - 境界不足（显示所需境界和当前境界）
    - 宗门要求不满足
    - 属性要求不满足（显示所有不满足的属性详情）
  - 改进属性检查显示，将多个不满足的属性合并显示在一个弹窗中
  - 保留原有的日志记录，便于追踪

### 📚 代码优化
- 优化AI服务的数据验证逻辑，提升错误处理能力
- 改进历练核心处理逻辑，增强数据安全性

---

## [0.1.1] - 2024-12-05

### 🎉 新增功能
- **功法系统**: 添加功法品级分类系统
  - 新增天、地、玄、黄四个品级分类
  - 功法列表中显示品级标签，不同品级有不同颜色标识
  - 添加品级筛选功能，可按品级筛选功法
  - 新增20种新功法到功法池中
- **抽奖券系统**: 改为本地概率判定
  - 不再依赖AI返回抽奖券奖励
  - 每次历练有5%概率获得抽奖券（可在代码中调整1%-10%范围）
  - 获得数量在1-10张之间随机

### 🐛 Bug修复
- **功法界面**: 修复打开功法界面时React Hooks调用顺序错误
  - 将条件返回移到所有Hooks调用之后，符合React Hooks规则
  - 修复"Rendered more hooks than during the previous render"错误

### 🔧 优化改进
- **功法界面**: 优化功法列表显示
  - 添加空状态提示（无符合条件的功法时显示）
  - 改进品级标签的视觉效果
  - 添加类型筛选和品级筛选的UI优化

### 📚 代码优化
- 为所有现有功法添加了品级属性
- 更新了CultivationArt接口，添加grade字段
- 优化了抽奖券获取逻辑，提升游戏体验的稳定性

---

## [0.1.0] - 2024-12-05

### 🐛 Bug修复
- **战斗系统**: 修复回合制战斗界面技能列表无法滚动的问题
  - 技能列表添加滚动功能，现在可以查看所有可用/不可用技能
  - 丹药列表同样支持滚动显示

### 🔧 优化改进
- **Docker部署**: 完善Docker环境变量配置
  - 支持在构建时注入Vite环境变量（VITE_AI_KEY等）
  - 更新Dockerfile，添加构建参数（ARG）支持
  - 优化docker-compose.yml配置，自动读取.env文件
  - 新增镜像打包和迁移指南
  - 添加 npm 脚本实现一键构建和打包（`docker:build-and-pack`）
  - 添加 npm 脚本实现一键构建和启动（`docker:build-and-up`）

### 📚 文档更新
- 完善Docker部署文档（DOCKER.md）
  - 添加环境变量详细配置说明
  - 新增镜像打包成tar文件的完整流程
  - 补充导入/导出镜像的操作指南
  - 添加快速命令参考表（npm 脚本和 Makefile）
- 新增版本更新日志（CHANGELOG.md）
  - 记录版本更新历史
  - 提供功能计划路线图
- 新增 Makefile
  - 为习惯使用 make 命令的用户提供便利
  - 包含所有常用 Docker 操作命令
- 新增 Docker 使用示例文档（DOCKER_EXAMPLES.md）
  - 提供 7 个常见场景的完整示例
  - 包含故障排查和最佳实践
  - 详细的问答和快速参考表

### 🎨 界面优化
- **设置界面**: 添加版本号显示
  - 显示当前游戏版本（v0.1.0）
  - 添加"查看更新日志"快捷链接

---

## 版本说明

### 版本号规则
本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/) 规范：
- **主版本号（MAJOR）**: 不兼容的API修改
- **次版本号（MINOR）**: 向下兼容的功能性新增
- **修订号（PATCH）**: 向下兼容的问题修正

### 更新类型标识
- 🎉 **新增功能**: 新增的游戏功能或特性
- 🐛 **Bug修复**: 修复的问题和bug
- 🔧 **优化改进**: 性能优化、用户体验改进
- 💥 **破坏性变更**: 不向下兼容的更改
- 🎨 **界面优化**: UI/UX相关改进
- 📚 **文档更新**: 文档和说明的更新
- 🔒 **安全更新**: 安全相关的修复和更新

---

## [计划中的功能]

### 游戏系统
- [ ] 更多秘境探索内容
- [ ] 灵宠进阶系统
- [ ] 宗门任务系统
- [ ] 社交功能（好友、聊天）

### 技术优化
- [ ] 游戏存档云同步
- [ ] 移动端适配优化
- [ ] 性能优化（大数据量处理）

### 界面改进
- [ ] 更多动画效果
- [ ] 可自定义主题
- [ ] 快捷键支持

---

## 历史版本

*历史版本信息将在正式发版时补充*

---

## 反馈与建议

如果您在使用过程中遇到问题或有改进建议，欢迎：
- 提交 [GitHub Issue](https://github.com/your-repo/react-xiuxian-game/issues)
- 联系开发团队

感谢您的支持！

